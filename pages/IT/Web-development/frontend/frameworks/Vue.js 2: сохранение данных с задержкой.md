# Vue.js 2: сохранение данных с задержкой.
**_или как использовать throttle в новой версии_**

В Vue.js 1.х к полю можно добавлять атрибут debounce, что добавит задержку перед синхронизацией нового значения с моделью:

```html
<input v-model="field" debounce="500">
```

В этом случае обновление значения `field` в модели произойдёт с задержкой в 0,5 секунды.

К релизу Vue.js 2 этот подход переосмыслили и решили, что неправильно задерживать синхронизацию нового значения с моделью. И эти атрибуты удалили. А реализовывать, например отложенную отправку на сервер, предложили самостоятельно.

Длительные поиски заканчивались на вариантах, где предлагали реализовать ещё одну функцию в methods и вызывать её. У меня такой вариант упорно не хотел работать. Наконец нашлось ещё одно решение через вычисляемую переменную.

Нам потребуется собственно функция `throttle`. Можно взять из какой-либо библиотеки или один из примеров реализации в интернетах:

```javascript
export default function throttle (callback, limit) {
    var wait = false;
    return function () {
        if (!wait) {
            callback.call();
            wait = true;
            setTimeout(function () {
                wait = false;
            }, limit);
        }
    }
}
```

Сохраняем функцию отдельным модулем, которым дальше воспользуемся.

Для примера возьмём небольшой компонент, состоящий из текстового поля и метода сохранения:

```html
<template>
    <input type="text" v-model="field" />
</template>

<script>
export default {
    props: ['field'],
    methods: {
        save: function() {
            console.log(`Сохраняем новое значение ${this.field}`);
            // ... сохраняем на сервер
        }
    }
}
</script>
```

Любые изменения в поле синхронизируются с моделью автоматически. А функцию сохранения на сервер можно привязать например на событие `input`:

```html
<input type="text" v-model="field" @input="save" />
```

Теперь функция `save` вызывается на каждый набранный символ.

Подключаем `throttle`, добавляем вычисляемую переменную `throttledSave`, которая с задержкой в 1 секунду будет вызывать метод `save`:

```javascript
<script>
import throttle from 'throttle.js';

export default {
    props: ['field'],
    methods: {
        save: function() {
            console.log(`Сохраняем новое значение ${this.field}`);
            // ... сохраняем на сервер
        }
    },
    computed: {
        throttledSave: function() {
            let DELAY = 1000;
            return throttle(this.save, DELAY);
        }
    }
}
</script>
```

И привяжем на изменение поля эту вычисляемую переменную:

```html
<input type="text" v-model="field" @input="throttledSave" />
```

Готово! После окончания изменений в поле и задержки в 1 секунду функция `save` выполнится один раз.

**Источник**: https://medium.com
