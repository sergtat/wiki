# AUFS и каскадное монтирование

Пишу ещё раз, разжевывая, от установки системы (для более полного понимания), её можете пропустить :

1. Ставите систему;
2. Ядро собираете с поддержкой aufs или отдельный модуль;
3. Устанавливаете нужные сервисы, что бы создать структуру каталогов в /var, /var/log и прочем;
4. Создаёте, предположим в /mnt/, директории /mnt/log/ro и /mnt/log/rw;
5. Переносите фалы из /var/log/* в /mnt/log/rw;
6. На /mnt/log/rw монтируете tmpfs;
7. Собственно каскадно монтируете через aufs /mnt/log/ro и /mnt/log/rw на /var/log

```sh
shm     /mnt/log/rw tmpfs   defaults 0 0
var     /var/log        aufs    udba=reval,br:/mnt/log/rw:/mnt/log/ro  0 0
```
Теперь необходимая структура директорий для /var у вас будет лежать в /mnt/log/ro, при необходимости записи в /var/log посредством aufs будет происходить запись в tmpfs, смонтированной в /mnt/log/rw.

При необходимости установить какой-либо новый сервис после его установки переносите директории и прочие файлы, необходимые для его работы в /mnt/log/ro.
