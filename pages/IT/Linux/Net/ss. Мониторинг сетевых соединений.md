# Мониторинг сетевых соединений при помощи ss
Утилита с коротким названием ss позволяет системному администратору получать детальную статистическую информацию об использовании сокетов в системе. Эта утилита по своему предназначению похожа на netstat, однако имеет несколько более богатые возможности, а также является более быстрой. При помощи ss вы можете получать информацию о:

    TCP-сокетах;
    UDP-сокетах;
    установленных ssh/ftp/http/https соединениях;
    локальных процессах, подключённых к X-серверу;
    сокетах, находящихся в состоянии FIN-WAIT-1;
    и многое другое.
Большинство современных дистрибутивов Linux поставляются вместе с ss. Научившись работать с ней наряду с другими подобными утилитами, вы получите в свой арсенал ещё один замечательный инструмент, позволяющий вам в сложных ситуациях находить источники проблем производительности вашей системы.

## Общая информация о соединениях:

```bash
# ss -s
Total: 362 (kernel 371)
TCP:   210 (estab 81, closed 28, orphaned 0, synrecv 0, timewait 27/0), ports 0

Transport Total     IP        IPv6
*      371       -         -
RAW      0         0         0
UDP      19        17        2
TCP      182       169       13
INET      201       186       15
FRAG      0         0         0
```
Информация об ожидающих соединений сокетах:

```bash
# ss -l
Recv-Q Send-Q                           Local Address:Port                               Peer Address:Port
0      128                                          *:9092                                          *:*
0      50                                          :::xmpp-client                                  :::*
0      50                                          :::5223                                         :::*
0      5                                           :::rsync                                        :::*
0      5                                            *:rsync                                         *:*
0      50                                   127.0.0.1:mysql                                         *:*
0      50                                           *:netbios-ssn                                   *:*
0      50                                          :::5229                                         :::*
0      128                                          *:sunrpc                                        *:*
0      128                                          *:www                                           *:*
0      128                                         :::51122                                        :::*
0      128                                          *:51122                                         *:*
0      64                                           *:50355                                         *:*
0      128                                          *:42451                                         *:*
0      3                                     10.8.0.5:domain                                        *:*
0      3                                     10.1.0.1:domain                                        *:*
0      128                                          *:munin                                         *:*
0      5                                            *:ftp                                           *:*
0      3                                  192.168.0.1:domain                                        *:*
0      3                                    127.0.0.1:domain                                        *:*
0      3                                           :::domain                                       :::*
0      128                                         :::ssh                                          :::*
0      128                                          *:ssh                                           *:*
0      128                                         :::51000                                        :::*
0      128                                   10.8.0.5:51000                                         *:*
0      128                                   10.1.0.1:3128                                          *:*
0      128                                192.168.0.1:3128                                          *:*
0      100                                192.168.0.1:smtp                                          *:*
0      100                                  127.0.0.1:smtp                                          *:*
0      128                                        ::1:953                                          :::*
0      128                                  127.0.0.1:953                                           *:*
0      128                                          *:58523                                         *:*
0      5                                            *:65021                                         *:*
0      50                                           *:microsoft-ds                                  *:*
0      50                                          :::7777                                         :::*
0      64                                           *:nfs                                           *:*
0      50                                          :::9091                                         :::*
```
Информация об ожидающих соединений сокетах, а также именах процессов, их использующих:

```bash
# ss -lp
Recv-Q Send-Q           Local Address:Port               Peer Address:Port
0      128                          *:9092                          *:*        users:(("transmission-da",15749,9))
0      50                          :::xmpp-client                  :::*        users:(("java",3219,69))
0      50                          :::5223                         :::*        users:(("java",3219,73))
0      5                           :::rsync                        :::*        users:(("rsync",2906,5))
0      5                            *:rsync                         *:*        users:(("rsync",2906,4))
0      50                   127.0.0.1:mysql                         *:*        users:(("mysqld",2815,10))
0      50                           *:netbios-ssn                   *:*        users:(("smbd",2749,24))
0      50                          :::5229                         :::*        users:(("java",3219,33))
0      128                          *:sunrpc                        *:*        users:(("portmap",623,5))
0      128                          *:www                           *:*        users:(("apache2",3203,4),("apache2",15371,4),("apache2",17764,4))
0      128                         :::51122                        :::*        users:(("sshd",752,4))
0      128                          *:51122                         *:*        users:(("sshd",752,3))
0      64                           *:50355                         *:*
0      128                          *:42451                         *:*        users:(("rpc.statd",938,9))
0      3                     10.8.0.5:domain                        *:*        users:(("named",874,26))
0      3                     10.1.0.1:domain                        *:*        users:(("named",874,25))
0      128                          *:munin                         *:*        users:(("munin-node",3299,5))
0      5                            *:ftp                           *:*        users:(("proftpd",3125,1))
0      3                  192.168.0.1:domain                        *:*        users:(("named",874,22))
0      3                    127.0.0.1:domain                        *:*        users:(("named",874,21))
0      3                           :::domain                       :::*        users:(("named",874,20))
0      128                         :::ssh                          :::*        users:(("sshd",752,6))
0      128                          *:ssh                           *:*        users:(("sshd",752,5))
0      128                         :::51000                        :::*        users:(("transmission-da",15749,11))
0      128                   10.8.0.5:51000                         *:*        users:(("transmission-da",15749,10))
0      128                   10.1.0.1:3128                          *:*        users:(("squid",2877,15))
0      128                192.168.0.1:3128                          *:*        users:(("squid",2877,14))
0      100                192.168.0.1:smtp                          *:*        users:(("master",3056,13))
0      100                  127.0.0.1:smtp                          *:*        users:(("master",3056,12))
0      128                        ::1:953                          :::*        users:(("named",874,24))
0      128                  127.0.0.1:953                           *:*        users:(("named",874,23))
0      128                          *:58523                         *:*        users:(("rpc.mountd",2696,8))
0      5                            *:65021                         *:*        users:(("proftpd",3125,2))
0      50                           *:microsoft-ds                  *:*        users:(("smbd",2749,23))
0      50                          :::7777                         :::*        users:(("java",3219,29))
0      64                           *:nfs                           *:*
0      50                          :::9091                         :::*        users:(("java",3219,45))
```
Информация обо всех задействованных TCP сокетах:

```bash
# ss -at
```
Информация обо всех задействованных UDP сокетах:

```bash
# ss -au
```
Информация обо всех установленных SMTP-соединениях:

```bash
# ss -o state established '( dport = :smtp or sport = :smtp )'
```
Информация обо всех установленных HTTP-соединениях:

```bash
# ss -o state established '( dport = :http or sport = :http )'
```
Локальные процессы, подключённые к X-серверу:

```bash
# ss -x src /tmp/.X11-unix/*
```
TCP-сокеты, находящиеся в состоянии FIN-WAIT-1 для соединений из подсети 202.54.1./24:

```bash
# ss -o state fin-wait-1 '( sport = :http or sport = :https )' dst 202.54.1/24
```
> По материалам cyberciti.biz
