# Base: Использование в формах списка.
## Использование в формах списка с предопределнными значениями.

Выпадающий список в форме может быть не связан с данными из другой таблицы. В этом случае данные, которые показываются в списке настраиваются в нем самом.

Ниже представлена подробная инструкция по созданию такого выпадающего списка. (Про создание выпадающего списка с данными из базы можно прочитать здесь).

### Вариант 1. Список отображает данные так же как они и хранятся в базе.

Создаём простейшую таблицу.

![Base: Использование в формах списка](/images/Linux/Software/base_list_001.png 'Base: Использование в формах списка')

Создадим с помощью мастера форму с полем «Текущий год». Здесь рассматривается пример с отдельно стоящим списком, для списка в таблице список настраивается так же, только настройка делается для колонки.

![Base: Использование в формах списка](/images/Linux/Software/base_list_002.png 'Base: Использование в формах списка')

При нажатой клавише Ctrl выбираем мышью текстовое поле (левая кнопка мыши). После этого нажимаем правую кнопку мыши. В поднявшемся меню выбираем пункт «Заменить на» и далее выбираем список.

![Base: Использование в формах списка](/images/Linux/Software/base_list_003.png 'Base: Использование в формах списка')

В свойствах списка в поле «Раскрываемый» выбираем «Да».

![Base: Использование в формах списка](/images/Linux/Software/base_list_004.png 'Base: Использование в формах списка')

Что бы убедиться в том, что содержимое списка не привязано к таблицам, перейдём на закладку «Данные». В поле «Тип содержимого списка» должно быть указано «Список значений».

![Base: Использование в формах списка](/images/Linux/Software/base_list_005.png 'Base: Использование в формах списка')

Список значений заполняем на вкладке «Общие» в поле «Элементы списка». Для ввода каждого следующего элемента необходимо нажать Shift+Enter. Для окончания ввода — Enter.

![Base: Использование в формах списка](/images/Linux/Software/base_list_006.png 'Base: Использование в формах списка')

В принципе на этом настройку списка можно завершить. Но не лишним будет задать и значение по умолчанию (это полезно при вводе новой записи в таблицу). Жмём на кнопку с тремя точками (не список открываем, а именно кнопку жмём) напротив метки «Выбор по умолчанию». Поднимется диалог для выбора значения по умолчанию.

![Base: Использование в формах списка](/images/Linux/Software/base_list_007.png 'Base: Использование в формах списка')

Выбираем, жмём кнопку «OK» и обнаруживаем такой результат — значение поля «Выбор по умолчанию» не «2009» как можно было бы ожидать с первого взгляда, а «1», то есть порядковый номер выбранного элемента списка (нумерация начинается с нуля).

![Base: Использование в формах списка](/images/Linux/Software/base_list_008.png 'Base: Использование в формах списка')

Примечание. Если по какой-либо причине форма не привязана к данным, то значение по умолчанию не будет работать. То есть в элементе управления будет сохраняться последнее выбранное значение из списка, а не значение по умолчанию. Если форма к данным привязана, и даже если список не привязан к какому-либо полю данных, то в этом случае значение по умолчанию работает.

## Вариант 2. Список отображает данные не так как они хранятся в базе.

Рассмотрим другую таблицу базы данных. Обращаем внимание на поле «Периодичность» с типом SMALLINT.

![Base: Использование в формах списка](/images/Linux/Software/base_list_009.png 'Base: Использование в формах списка')

На этот раз рассмотрим настройку выпадающего списка внутри табличного элемента управления.

![Base: Использование в формах списка](/images/Linux/Software/base_list_010.png 'Base: Использование в формах списка')

Выбираем колонку «Периодичность» и меняем на Список.

![Base: Использование в формах списка](/images/Linux/Software/base_list_011.png 'Base: Использование в формах списка')

Для редактирования свойств установленного списка во всплывающем меню колонки «Периодичность» выбираем элемент «Столбец...».

![Base: Использование в формах списка](/images/Linux/Software/base_list_012.png 'Base: Использование в формах списка')

В этом примере в выпадающем списке мы будем показывать не цифры, а строковые значения, что и вводим в поле «Элементы списка» (не забываем Shift+Enter для ввода значений).

![Base: Использование в формах списка](/images/Linux/Software/base_list_013.png 'Base: Использование в формах списка')

Так как данные для этого поля в базе хранятся не в том виде, в котором мы его будем показывать, то для связи с данными необходимо заполнить поле «Содержимое списка» на закладке «Данные» (опять не забываем про Shift+Enter). Порядок числовых значений должен соответствовать порядку строковых значений.

![Base: Использование в формах списка](/images/Linux/Software/base_list_014.png 'Base: Использование в формах списка')

И напоследок - любимое мною значение по умолчанию. Нажатие на кнопку с тремя точками около метки «Выбор по умолчанию» приводит к странному результату: список пуст.

![Base: Использование в формах списка](/images/Linux/Software/base_list_015.png 'Base: Использование в формах списка')

Но так как принцип этой настройки нам известен (устанавливается порядковый номер нужного значения начиная с нуля), то смело пишем в это поле значение 2 для выбора периодичности с названием «Месяц».

![Base: Использование в формах списка](/images/Linux/Software/base_list_016.png 'Base: Использование в формах списка')

> Примечание. Пустой диалог для выбора по умолчанию у меня появляется только для списка в таблице, для отдельно стоящего списка диалог «Значение по умолчанию» заполнен правильными данными.

## Как связать таблицы
### Вариант 1.

![Base: Использование в формах списка](/images/Linux/Software/base_lists_001.png 'Base: Использование в формах списка')

Создать связь между таблицами: в меню: Сервис-Связи.

![Base: Использование в формах списка](/images/Linux/Software/base_lists_002.png 'Base: Использование в формах списка')

Затем добавить обе таблицы. Взять мышкой за ключ iduser в Таблице 2 и потянуть его до поля iduser в Таблице 1.

![Base: Использование в формах списка](/images/Linux/Software/base_lists_003.png 'Base: Использование в формах списка')

Создать Представление (там же, где и таблицы).

![Base: Использование в формах списка](/images/Linux/Software/base_lists_004.png 'Base: Использование в формах списка')

Далее как в запросе: Добавить Таблицу 2. Выбрать из списка первого столбца:

- в Поле nameuser,
- в Таблица tbl_Tablica-2,
- из списка второго столбца в Поле iduser,
- в Таблица tbl_Tablica-2, не забудьте поставить галочки в квадратиках.

В Представлении будут только два поля:

1. nameuser из Таблицы 2;
2. iduser из Таблицы 2.

![Base: Использование в формах списка](/images/Linux/Software/base_lists_005.png 'Base: Использование в формах списка')

После создания формы на основе Таблицы 1, заменить поле в iduser на список.

![Base: Использование в формах списка](/images/Linux/Software/base_lists_006.png 'Base: Использование в формах списка')

В поле Списка кликнуть мышью, выбрать Элемент управления,

![Base: Использование в формах списка](/images/Linux/Software/base_lists_007.png 'Base: Использование в формах списка')

далее в Данные, в Тип содержимого списка заменить на Таблицу, в Содержимое списка заменить на Представление, а в Связываемое поле поставить поле 1 (т.е. Nameuser).

![Base: Использование в формах списка](/images/Linux/Software/base_lists_008.png 'Base: Использование в формах списка')

**ИТОГ: В соответствующее поле Таблицы 1 записывается id а в Форме отображается текст из nameuser Представления.**

### Вариант 2.

![Base: Использование в формах списка](/images/Linux/Software/base_lists_009.png 'Base: Использование в формах списка')

- Меняются местами поля iduser и nameuser в Таблице 2.
- Создать связь между таблицами.
- Представление не создается.
- После создания формы на основе Таблицы 1, заменить поле в iduser на список.
- В поле Списка кликнуть мышью, выбрать Элемент управления, далее в Данные, в Тип содержимого списка заменить на Таблицу, в Содержимое списка заменить на Таблицу 2, а в Связываемое поле поставить поле 1 ( т.е. Nameuser).

![Base: Использование в формах списка](/images/Linux/Software/base_lists_010.png 'Base: Использование в формах списка')

**ИТОГ: В соответствующее поле Таблицы 1 записывается id а в Форме отображается текст из nameuser Таблицы 2.**

### Вариант 3.

![Base: Использование в формах списка](/images/Linux/Software/base_lists_011.png 'Base: Использование в формах списка')

Главное условие - чтобы названия полей совпадали.

- В Таблице 2 только одно поле nameuser - оно текстовое и является ключом.
- Создать связь между таблицами.
- Представление не создается.
- После создания формы на основе Таблицы 1, заменить поле в iduser на Поле со списком.

![Base: Использование в формах списка](/images/Linux/Software/base_lists_012.png 'Base: Использование в формах списка')

В поле Поле со списком кликнуть мышью, выбрать Элемент управления, далее в Данные, в Тип содержимого списка заменить на Таблицу, в Содержимое списка заменить на Таблицу 2.

**ИТОГ: В соответствующее поле Таблицы 1 будет писаться текст из nameuser Таблицы 2. В форме отображается текст из nameuser Таблицы 2.**

### Вариант 4.

![Base: Использование в формах списка](/images/Linux/Software/base_lists_013.png 'Base: Использование в формах списка')

Смотри Таблицу 1 — как в третьем варианте, а Таблицу 2 — как в первом.

Главное условие - чтобы названия полей совпадали.

- Связь между таблицами не создавать.
- После создания формы на основе Таблицы 1, заменить поле в nameuser на Поле со списком.
- В поле Поле со списком кликнуть мышью, выбрать Элемент управления, далее в Данные, в Тип содержимого списка заменить на Таблицу, в Содержимое списка заменить на Таблицу 2, как в предыдущем Варианте.

**ИТОГ: В соответствующее поле Таблицы 1 будет писаться текст из nameuser Таблицы 2. В форме отображается текст из nameuser Таблицы 2.**

### вариант 5.

![Base: Использование в формах списка](/images/Linux/Software/base_lists_014.png 'Base: Использование в формах списка')

Обе Таблицы - как в предыдущем варианте.

- Связь между таблицами не создавать.
- После создания формы на основе Таблицы 1, заменить поле в nameuser на Поле со списком.
- В поле Поле со списком кликнуть мышью, выбрать Элемент управления, далее в Данные, в Тип содержимого списка заменить на Sql, в Содержимое списка заменить на: SELECT "nameuser" FROM "tbl_Tablica-2". Или сгенерировать запрос SQL в конструкторе Команда SQL (начиная с версии OpenOffice.org 2.4), добавив туда Таблицу 2. Далее - как в запросе (Добавить Таблицу 2. Выбрать из списка в Поле  nameuser, в Таблица tbl_Tablica-2, не забудьте поставить галочку в квадратик).

![Base: Использование в формах списка](/images/Linux/Software/base_lists_015.png 'Base: Использование в формах списка')

![Base: Использование в формах списка](/images/Linux/Software/base_lists_016.png 'Base: Использование в формах списка')

**ИТОГ: В соответствующее поле Таблицы 1 будет писаться текст из nameuser Таблицы 2. В форме отображается текст из nameuser Таблицы 2.**

**P.S.**

Если ваша форма в виде таблицы, то применяем все то же самое. Только вместо заменить поле в iduser на список, кликаем мышью на названии столбца iduser и выбираем Заменить на список.

![Base: Использование в формах списка](/images/Linux/Software/base_lists_017.png 'Base: Использование в формах списка')

Вместо Элемент управления выбрать Столбец.

![Base: Использование в формах списка](/images/Linux/Software/base_lists_018.png 'Base: Использование в формах списка')

![Base: Использование в формах списка](/images/Linux/Software/base_lists_019.png 'Base: Использование в формах списка')

**P.P.S.**

При редактировании формы во вкладке Общие сделайте список раскрываемым.

На представленных изображениях все списки раскрываемые, поэтому справа видны треугольники.

![Base: Использование в формах списка](/images/Linux/Software/base_lists_018.png 'Base: Использование в формах списка')

**Источники**: http://myooo.ru https://wiki.openoffice.org
