# Xposed
**Xposed - Программа для изменения настроек приложений и прошивок без необходимости их декомпиляции, компиляции и подписи для Андроид**. Одним из неоспоримых достоинств операционной системы Google Android является возможность её изменения и настроек в довольно широких пределах. Однако, для того, чтобы выйти за рамки, которые нам предоставляют такие приложения как лончеры или виджеты, нам как минимум нужно иметь на планшете или смартфоне права доступа root.

После получения root прав мы получаем возможность практически полного контроля над системой, за исключением, пожалуй, установки новых прошивок и патчей, кардинально меняющих как саму операционную систему, так и её функциональные возможности. Для этого нам уже нужно уже разблокировать загрузчик своего планшета или смартфона и установить на него альтернативное рекавери. Впрочем, есть еще один способ расширения возможностей вашего планшета или смартфона и я вам о нем сегодня хочу рассказать.

Если вы не хотите проводить достаточно рискованные процедуры по разблокированию загрузчика своего планшета и установки на него альтернативного рекавери, такого как TWRP или ClockworkMod, что влечет за собой потерю гарантии на планшет или телефон, или если вы хотите получить дополнительные возможности по расширению функциональности вашего устройства, то вам стоит обратить внимание на Xposed Framework, который позволяет устанавливать различные патчи и дополнения к операционной системе всего лишь при наличии root прав, без необходимости разблокирования загрузчика.

Xposed Framework является довольно новаторским решением, воспользоваться которым без особого риска может даже неподготовленный, не имеющий опыта в установке кастомных прошивок и модифицированных рекавери, пользователь.

Появлением Xposed Framework, который использует возможности root доступа для установки и запуска различных модулей, приносящих нам достаточно интересные возможности мы обязаны независимому разработчику с форума XDA-Developers, известному там под ником rovo89.

Потенциал его решения настолько велик и практически неограничен, что многие разработчики уже начали переходить на него для установки в систему своих модулей и патчей.

Итак, как вы можете получить все эти возможности на своем устройстве? Достаточно легко, не сложнее, чем установить любое стороннее приложение, что вы обычно делаете в пару-тройку кликов. Пожалуй, пора приступать?

## Прежде чем продолжить

> Внимание! Все что вы делаете, вы делаете на свой страх и риск. Ни наш сайт, ни разработчик Xposed Framework не несут ответственности за возможные перебои в работе или повреждения системы вашего устройства.

Для начала вам желательно сделать полную резервную копию вашей системы с помощью TWRP или ClockworkMod рекавери. Если вы не пользуетесь альтернативными рекавери, сделайте хотя бы резервные копии основных данных и приложений.

Кроме того, убедитесь, что вы используете Android 4.0 Ice Cream Sandwich или более позднюю версию операционной системы иначе Xposed у вас просто не будет работать. Наконец, как уже упоминалось, вы должны иметь root права на вашем смартфоне или планшете.

## Установка Xposed Framework

Загрузите самую свежую версию apk файла [Xposed Installer](http://dl.xposed.info/latest.apk) на свой планшет или смартфон и установите его, запустив с помощью любого менеджера файлов. После установки запустите приложение Xposed Installer, котрый вы найдете среди других программ в панели приложений вашего устройства.

После запуска приложения, откройте пункт Framework и нажмите на кнопку «Install/Update». Не волнуйтесь, если вам покажется, что приложение зависло – ему потребуется некоторое время, и в конечном итоге вы должны увидеть запрос Super User на предоставление Xposed Installer  root прав, которые вы должны ему предоставить.

После этого вы увидите окно, на котором будет отображаться процесс установки. По окончании установки вам нужно будет перезагрузить свой планшет или телефон, что вы можете сделать прямо из приложения, нажав на кнопку «Перезагрузка».

Всё, установка завершена. Сам по себе Xposed Framework не несет никаких новых функциональных возможностей для вашего устройства. Все изменения в системе производятся с помощью установки отдельных модулей, которые и предоставляют вам новые возможности.

Итак, теперь давайте посмотрим, как можно найти и установить новые модули для Xposed, что также делается достаточно просто.

## Установка модуля Xposed Framework

Модули для Xposed представляют собой обычные APK файлы, которые устанавливаются на устройство также, как и любой другой APK файл приложения. В программе Xposed Installer имеется специальный раздел для загрузки модулей: пункт главного меню «Download», в котором вы найдете множество проверенных и испытанных на различных устройствах модулей. Кроме того, новые модули для Xposed Framework в виде APK файлов вы можете найти на том же форуме XDA и других веб-сайтах.

Для начала установки модуля, опуститесь в самый низ страницы с его описанием и нажмите на кнопку «Download». Когда загрузка модуля будет завершена, вы увидите привычный диалог установки нового приложения, который появляется при установке любого APK файла. Установите его, после чего модуль появится в списке Modules главного меню Xposed Installer

## Включение и работа с модулями Xposed Framework

После установки нового модуля, никаких изменений в работе своего планшета или смартфона вы не заметите. Для того, чтобы они произошли, вам нужно будет его включить. Независимо от того, установили ли вы модуль с помощью Xposed Installer или скачали его и установили как обычный APK файл, вам будет показано уведомление с сообщением о том, что он в настоящий момент не активен. Кликните по этому уведомлению и вы попадете к разделу работы с модулями программы Xposed Installer (Также вы можете попасть туда и с помощью пункта Модули в главном меню Xposed Installer).

Для того, чтобы установить один из модулей, имеющихся в списке Xposed Installer, перейдите в раздел «Download». Вы увидите длинный перечень доступных модулей с описанием того, что он умеет делать. Выберите модуль, который вы хотели бы установить, нажав на него и вы увидите еще более подробное его описание в котором даже можно найти и скриншоты. Например, мы модуль расширенного меню питания, с помощью которое открывается при долговременном нажатии на кнопку выключения.

Здесь вы можете включить или отключить любой из доступных модулей, ставя соответствующую отметку напротив них.

Кликнув по любому модулю, вы попадете в меню его конфигурации, где можно будет поиграть с его настройками, установив их на свой вкус. Для того, чтобы изменения в настройках модуля вступили в силу может потребоваться перезагрузка планшета или телефона, о чем вам будет сообщено.

После того, как вы установили новый модуль и настроили его, вы можете насладиться новыми возможностями, которые он несет с собой. Например, если вы установили модуль расширенного меню питания (Advnced Power Menu), как на примере выше, вы увидите, что в меню, которое появляется при длительном нажатии на кнопку питания появились новые пункты, такие как перезагрузка в режим рекавери или возможность делать скриншоты с экрана устройства.

Наши читатели уже имели возможность убедиться в тех широких возможностях, которые Xposed Framework предоставляет владельцам Android планшетов и смартфонов. Например, с помощью него вы можете включать планшетный или телефонный вид интерфейса для отдельных приложений, что было доступно раньше только путем установки альтернативной прошивки. Кроме того, с помощью Xposed, владельцы устройств с более ранними, чем Android 4.2 версиями операционной системы первыми получили возможность избавить их от уязвимости Master Key и Bug 9695860.

При правильном подборе модулей вы можете значительно расширить возможности своего телефона или планшета, добавив на него множество интересных и полезных функций из самых популярных альтернативных (кастомных) прошивок, без необходимости каждый раз переустанавливать систему заново.

Полную информацию о фреймворке, а также помощь по решению всех вопросов связанных с ним вы можете получить в ветке его разработчика на форуме XDA, прейдя по [следующей ссылке](http://forum.xda-developers.com/xposed/framework-xposed-rom-modding-modifying-t1574401).

## FAQ ПО XPOSED

1. **Что такое Xposed и как она работает.**  
Любой класс в Android загружается с помощью небольшого нативного приложения `/system/bin/app_process`
Его задача - запустить виртуальную машину Dalvik,загрузить необходимые для работы системные классы(окружение исполнения) и передать управление классу (на самом деле происходит обращение к сервису Zygote, который форкает уже готовую ВМ и окружение в режиме copy-on- write, но в нашем случае это неважно).  
Xposed представляет собой модифицированную версию `app_process`, которая при запуске первым делом загружает в память специальный Java-класс - перехватчик, а лишь после него - оригинальный Java-клэсс. Перехватчик выступает в качестве посредника для любых вызовов Java-методов, инициированных оригинальным классом, и, в случае необходимости, перенаправляет их классу-обработчику.  
Последний как раз и занимается тем, что изменяет поведение системы. Например, для определения цвета текста приложения используют метод GetColor класса android.content.res. Resources. Если класс-обработчик перехватит этот метод и вернет вместо кода серого цвета код зеленого, все надписи в интерфейсе станут зелеными. Модификации могут быть и более сложными, например когда они связаны с альтернативной реализацией сразу нескольких методов и целых классов.  
В комплекте Xposed готовых классов-обработчиков нет, но он позволяет любому разработчику распространять их в виде обычных АРК-пакетов, а пользователю просто установить и активировать с помощью специального интерфейса. Другими словами, с помощью Xposed можно устанавливать и удалять модификации Android как обычные приложения, без необходимости в прошивке, копировании в системный каталог и без какого-либо риска.
2. **Требования к установке.**
	- Android 4.x.x на девайсе
	- Наличие рут-прав
	- Крайне желательно наличие кастомного рекавери и предварительно сделанный нандроид-бэкап системы!
	- **Важно:**
		- Xposed не поддерживает среду исполнения ART и при установке сама меняет её на dalvik.
		- Xposed не дружит с прошивками LEWA и MIUI. Для MIUI существует специальный аналог Xposed - WSM Tools, используйте его; на LEWA он тоже часто работает.
		- Не гарантируется работа Xposed (и самого девайса посде установки Xposed) на аппаратах с восьмиядерным процессором MTK6592 и стоковыми прошивками, т. к. они базируются на Aliyun OS, форке Андроида, несовместимом с Xposed.
3. **А с процессорами архитектуры x86 Xposed совместима?**  
Да, начиная с версии 2.4.1.
4. **А у меня Android 5.0 Lollipop - на него Xposed не ставится?**  
На данный момент Xposed не работает в среде ART и потому не поддерживает Android L, где ART - среда по умолчанию (плюс есть и некоторые другие причины). Как только поддержка появится, об этом будет объявлено. 
5. **Какую версию Xposed лучше ставить - 2.6.1 final или 2.7 beta?**  
Лучше стабильный релиз - т. е. 2.6.1. Бета - экспериментальная, тестовая версия, может работать нестабильно и создавать проблемы.
6. **Установка Xposed.**
	- Опционально: перезагружаетесь в рекавери и делаете нандроид-бэкап системы, чтобы потом не было мучительно больно уменьшить вероятность проблем, если в процессе установки что-то пойдет не так и девайс уйдет в бутлуп.  
	- Скачиваете инсталлятор Xposed Installer, устанавливаете как обычное приложение, открываете Xposed.  
	- Открываете раздел "Фреймворк", нажимаете кнопку "Установить/Обновить", через некоторое время от SU (программы суперюзера) приходит запрос на предоставление Xposed Installer рут-прав, выбираете "разрешить".
	- По окончанию установки появляется сообщение о необходимости перезагрузки девайса, нажимаете "OK" и перезагружаете девайс.
	- После успешной загрузки системы заходите в Xposed, в раздел "Фреймворк", и видите, что цифры версий app_process и XposedBridge.jar зеленого цвета. Всё успешно установилось, можете ставить нужные вам модули. Если цифры красного цвета, значит, Xposed установлен неверно и/или вы не перезагрузили девайс.
7. **При установке/обновлении Xposed сообщает об ошибках (часто "segmentation fault") и не устанавливается/не обновляется. Что делать?i**  
В Xposed выбираете режим установки - вручную через рекавери. Идете в свой файловый менеджер, в папку Xposed по пути sdcard/Android/data/de.robv.android.xposed.installer, находите там архив xposed.installer.zip, копируете его в корень карты памяти, загружаетесь в рекавери и прошиваете этот архив.
8. **У меня не хотят работать крайние версии Xposed, но отлично работает старая. Почему так и что делать?**  
Такое бывает; причина в несовместимости крайних версий с вашей прошивкой. Пользуйтесь старой версией или меняйте прошивку.
9. **Куда ставятся модули?**  
Туда же, куда и все обычные программы - в data/app или в data/app-asec.
10. **Как включить модуль?**  
После установки скачанного модуля вы увидите уведомление о том, что он пока не активен. Можете тапнуть по этому уведомлению - и попадете в раздел "Модули" Xposed. Отмечаете галкой нужный модуль и перезагружаете девайс (желательно прямо из Xposed). Дальше всё зависит от каждого конкретного модуля - одни не требуют настроек и включаются сразу после перезагрузки, другие представляют собой отдельные программы с массой настроек - в этом случае после выбора/изменения необходимых параметров снова нужна перезагрузка.
11. **Если я ставлю несколько модулей, нужно активировать их по отдельности - выбираешь один, а потом перезагрузка, потом другой и перезагрузка?**  
Нет, можно отметить все сразу и тогда уже перезагрузить девайс.
12. **У меня модуль не устанавливается (ошибки "сбой разбора пакета"/"ошибка при синтаксическом анализе пакета"/"файл несовместим")!**
	- Вы скачали битый файл. Перекачайте и попробуйте установить ещё раз.
	- На вашем девайсе неподходящая версия Андроида. Подберите модуль с аналогичными свойствами, рассчитанный на вашу версию ОС.
13. **Модуль установился, но не работает! В чем проблема?**
	- Убедитесь, что вы перезагрузили девайс после выбора модуля в Xposed (для его активации) и еще раз после настройки модуля. Настройки некоторых модулей (например, GravityBox) даже недоступны (при попытках доступа будет вылетать ошибка "фреймворк не отвечает"), пока вы не активируете модуль в Xposed. Помните, что любое изменение настроек модуля требует перезагрузки девайса.
	- Убедитесь, что вы не установили модуль на карту памяти. Ставьте модули во внутреннюю память.
	- Обратите внимание на системные требования модуля - возможно, модуль разработан для конкретного аппарата (прошивки). Помните, что если в его системных требованиях прямо сказано, что ваша прошвка не поддерживается, вероятность того, что он не будет работать как надо, крайне велика.
	- Модуль просто конфликтует с вашей прошивкой. Такое бывает: невозможно поддерживать весь зоопарк существующих стоковых и кастомных прошивок, которые зачастую уже очень сильно модифицированы. Поищите другой модуль с аналогичными свойствами.
14. **Мне больше не нужен Xposed, как правильно его удалить?**  
Открываете раздел "Фреймворк", нажимаете кнопку "удалить" и после перезагрузки удаляете Xposed как обычное приложение.
15. **Если я удалю Xposed, сделанные модификации сохранятся?**  
Нет. При удалении самой Xposed или её модулей, все сделанные ими модификации в framework-res также удалятся. Модификации "в работе" лишь до тех пор, пока установлен и работает фреймворк Xposed и модуль, ответственный за эти модификации.
16. **Попытка установки была неудачной, и теперь девайс не включается, зависая на заставке (постоянно перезагружается)! Что делать?!**
	- Не паниковать раньше времени.
	- В Xposed встроена опция так называемого "безопасного входа". Поэтому если ваш девайс ушел в бутлуп, прежде всего нужно попробовать загрузиться в безопасном режиме - для этого в момент начала загрузки несколько раз нажмите кнопку громкости (на некоторых девайсах кнопку меню), и ОС загрузится с отключенным фреймворком.
	- Если безопасный вход не сработал, загружаетесь в рекавери и прошиваете из папки sdcard/Android/data/de.robv.android.xposed.installer/files архив Xposed-Disabler-Recovery.zip.
	- Если и это не сработало, загружаетесь в рекавери и восстанавливаете предварительно сделанный нандроид-бэкап системы. Вы же его сделали, правда?..
	- Если нет - перепрошиваете девайс. Как это сделать, см. в теме его прошивки.
17. **Если качать модули из репозитория Xposed, куда они скачиваются?**  
В папку sdcard/Android/data/de.robv.android.xposed.installer/files. Еще можете проверить папку data/data/com.android.providers.downloads/cache.
18. **Судя по данным менеджера приложений, Xposed со временем начинает занимать все больше и больше места. Почему так?**  
Размер папки Xposed растет из-за неотключаемого логгирования. Исправить это можно следующим образом - по пути data/data/de.robv.android.xposed.installer/ удалить папку log и вместо нее создать файл log без расширения. 
19. **Можно ли перенести в новую прошивку настройки модулей Xposed, чтобы после установки прошивки не нужно было их снова настраивать?**
Можно - в пакет прошивки положить уже модифицированый `app_process` и `xpoded_bridge.jar`. Добавить в zip с прошивкой модули, а также их данные с уже готовыми настройками из /data/data.  
Еще вариант. Через Titanium Backup Pro сделать бэкап модулей, поместить его в прошивоный архив, установить Xposed методом "Вручную через рекавери". В результате вам придётся прошить прошивку, поверх неё зип с бэкапами модулей и xposed-installer-recovery.zip. Запуститесь - и всё должно работать.
16. **А как сделать свой модуль Xposed?**
[Вот инструкция](http://forum.xda-developers.com/showthread.php?t=2709324). Нужны знания программирования на Java и соответствующие инструменты.

## Где взять модули для Xposed?
Скачать прямо из Xposed (раздел "Загрузка", выбираете модуль, внизу страницы с его описанием нажимаете "установить")  
[Коллекция на 4PDA](http://4pda.ru/forum/index.php?showtopic=603033&st=0#entry19053779). Большие сводные посты лежат под спойлером "сборники". Работает поиск по теме по ключевому слову.  
[Репозиторий модулей Xposed](http://repo.xposed.info/module-overview). Работает поиск по ключевому слову.  
[Коллекция на XDA](http://forum.xda-developers.com/xposed/modules/index-xposed-modules-collection-post-t2327541). Список по дате обновления 

> <span class="red">Обращайте внимание на системные требования, предъявляемые к выбранным модулям!</span>
